{"ast":null,"code":"var _localStorage$getItem;import{createSlice}from\"@reduxjs/toolkit\";import{API}from\"../hook\";import axios from\"axios\";import{changeCart}from\"./Cart\";import{toast}from\"react-toastify\";const userSlice=createSlice({name:\"user\",initialState:{data:JSON.parse((_localStorage$getItem=localStorage.getItem(\"user\"))!==null&&_localStorage$getItem!==void 0?_localStorage$getItem:\"{}\"),loading:null,error:null},reducers:{setItems:(state,_ref)=>{let{payload}=_ref;state.data=payload;},setError:(state,_ref2)=>{let{payload}=_ref2;state.error=payload;},setLoading:(state,payload)=>{state.loading=payload;}}});export const{setItems,setError,setLoading}=userSlice.actions;export default userSlice.reducer;export const registration=data=>{return async dispatch=>{dispatch(setLoading(true));axios.post(\"\".concat(API,\"/auth/register/\"),data,{headers:{\"Content-Type\":\"multipart/form-data\"}}).then(response=>{dispatch(setItems(response.data));localStorage.setItem(\"token\",response.data.token);localStorage.setItem(\"user\",JSON.stringify(response.data));window.location.replace(\"/\");}).catch(error=>{dispatch(setError(error.response.data));dispatch(setLoading(false));}).finally(()=>{toast.success(\"ðŸ¦„ Wow so easy!\",{position:\"top-right\",autoClose:5000,hideProgressBar:false,closeOnClick:true,pauseOnHover:true,draggable:true,progress:undefined,theme:\"light\"});dispatch(setLoading(false));});};};export const login=data=>{return async dispatch=>{dispatch(setLoading(true));axios.post(\"\".concat(API,\"/auth/login/\"),data).then(response=>{dispatch(setItems(response.data));localStorage.setItem(\"token\",response.data.token_key);localStorage.setItem(\"user\",JSON.stringify(response.data));window.location.replace(\"/\");}).catch(error=>{dispatch(setLoading(false));dispatch(setError(error.response.data));}).finally(()=>dispatch(setLoading(false)));};};export const getProfile=id=>{return async dispatch=>{dispatch(setLoading(true));axios.get(\"\".concat(API,\"/auth/profile/\").concat(id,\"/\")).then(response=>{dispatch(setItems(response.data));localStorage.setItem(\"token\",response.data.token_key);localStorage.setItem(\"user\",JSON.stringify(response.data));}).catch(error=>{dispatch(setLoading(false));dispatch(setError(error.response.data));}).finally(()=>dispatch(setLoading(false)));};};export const changeUserData=(data,id,back)=>{return async dispatch=>{dispatch(setLoading(true));axios.patch(\"\".concat(API,\"/auth/profile/\").concat(id,\"/\"),data,{headers:{\"Content-Type\":\"multipart/form-data\"}}).then(response=>{dispatch(setItems(response.data));localStorage.setItem(\"token\",response.data.token_key);localStorage.setItem(\"user\",JSON.stringify(response.data));back();}).catch(error=>{dispatch(setLoading(false));dispatch(setError(error.response.data));}).finally(()=>{dispatch(setLoading(false));});};};export const changeUserPassword=(data,back)=>{return async dispatch=>{dispatch(setLoading(true));const token=\"Token \".concat(localStorage.getItem(\"token\"));axios.patch(\"\".concat(API,\"/auth/change-password/\"),data,{headers:{Authorization:token}}).then(()=>{back();}).catch(error=>{dispatch(setLoading(false));dispatch(setError(error.response.data));}).finally(()=>{dispatch(setLoading(false));});};};","map":{"version":3,"names":["createSlice","API","axios","changeCart","toast","userSlice","name","initialState","data","JSON","parse","_localStorage$getItem","localStorage","getItem","loading","error","reducers","setItems","state","_ref","payload","setError","_ref2","setLoading","actions","reducer","registration","dispatch","post","concat","headers","then","response","setItem","token","stringify","window","location","replace","catch","finally","success","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","undefined","theme","login","token_key","getProfile","id","get","changeUserData","back","patch","changeUserPassword","Authorization"],"sources":["/Users/muhammad/Downloads/ayfamarket-main/src/store/slices/User.js"],"sourcesContent":["import { createSlice } from \"@reduxjs/toolkit\";\r\nimport { API } from \"../hook\";\r\nimport axios from \"axios\";\r\nimport { changeCart } from \"./Cart\";\r\nimport { toast } from \"react-toastify\";\r\n\r\nconst userSlice = createSlice({\r\n  name: \"user\",\r\n  initialState: {\r\n    data: JSON.parse(localStorage.getItem(\"user\") ?? \"{}\"),\r\n    loading: null,\r\n    error: null,\r\n  },\r\n  reducers: {\r\n    setItems: (state, { payload }) => {\r\n      state.data = payload;\r\n    },\r\n    setError: (state, { payload }) => {\r\n      state.error = payload;\r\n    },\r\n    setLoading: (state, payload) => {\r\n      state.loading = payload;\r\n    },\r\n  },\r\n});\r\n\r\nexport const { setItems, setError, setLoading } = userSlice.actions;\r\nexport default userSlice.reducer;\r\n\r\nexport const registration = (data) => {\r\n  return async (dispatch) => {\r\n    dispatch(setLoading(true));\r\n    axios\r\n      .post(`${API}/auth/register/`, data, {\r\n        headers: {\r\n          \"Content-Type\": \"multipart/form-data\",\r\n        },\r\n      })\r\n      .then((response) => {\r\n        dispatch(setItems(response.data));\r\n        localStorage.setItem(\"token\", response.data.token);\r\n        localStorage.setItem(\"user\", JSON.stringify(response.data));\r\n        window.location.replace(\"/\");\r\n      })\r\n      .catch((error) => {\r\n        dispatch(setError(error.response.data));\r\n        dispatch(setLoading(false));\r\n      })\r\n      .finally(() => {\r\n        toast.success(\"ðŸ¦„ Wow so easy!\", {\r\n          position: \"top-right\",\r\n          autoClose: 5000,\r\n          hideProgressBar: false,\r\n          closeOnClick: true,\r\n          pauseOnHover: true,\r\n          draggable: true,\r\n          progress: undefined,\r\n          theme: \"light\",\r\n        });\r\n        dispatch(setLoading(false));\r\n      });\r\n  };\r\n};\r\n\r\nexport const login = (data) => {\r\n  return async (dispatch) => {\r\n    dispatch(setLoading(true));\r\n    axios\r\n      .post(`${API}/auth/login/`, data)\r\n      .then((response) => {\r\n        dispatch(setItems(response.data));\r\n        localStorage.setItem(\"token\", response.data.token_key);\r\n        localStorage.setItem(\"user\", JSON.stringify(response.data));\r\n        window.location.replace(\"/\");\r\n      })\r\n      .catch((error) => {\r\n        dispatch(setLoading(false));\r\n        dispatch(setError(error.response.data));\r\n      })\r\n      .finally(() => dispatch(setLoading(false)));\r\n  };\r\n};\r\n\r\nexport const getProfile = (id) => {\r\n  return async (dispatch) => {\r\n    dispatch(setLoading(true));\r\n    axios\r\n      .get(`${API}/auth/profile/${id}/`)\r\n      .then((response) => {\r\n        dispatch(setItems(response.data));\r\n        localStorage.setItem(\"token\", response.data.token_key);\r\n        localStorage.setItem(\"user\", JSON.stringify(response.data));\r\n      })\r\n      .catch((error) => {\r\n        dispatch(setLoading(false));\r\n        dispatch(setError(error.response.data));\r\n      })\r\n      .finally(() => dispatch(setLoading(false)));\r\n  };\r\n};\r\n\r\nexport const changeUserData = (data, id, back) => {\r\n  return async (dispatch) => {\r\n    dispatch(setLoading(true));\r\n    axios\r\n      .patch(`${API}/auth/profile/${id}/`, data, {\r\n        headers: {\r\n          \"Content-Type\": \"multipart/form-data\",\r\n        },\r\n      })\r\n      .then((response) => {\r\n        dispatch(setItems(response.data));\r\n        localStorage.setItem(\"token\", response.data.token_key);\r\n        localStorage.setItem(\"user\", JSON.stringify(response.data));\r\n        back();\r\n      })\r\n      .catch((error) => {\r\n        dispatch(setLoading(false));\r\n        dispatch(setError(error.response.data));\r\n      })\r\n      .finally(() => {\r\n        dispatch(setLoading(false));\r\n      });\r\n  };\r\n};\r\n\r\nexport const changeUserPassword = (data, back) => {\r\n  return async (dispatch) => {\r\n    dispatch(setLoading(true));\r\n    const token = `Token ${localStorage.getItem(\"token\")}`;\r\n    axios\r\n      .patch(`${API}/auth/change-password/`, data, {\r\n        headers: { Authorization: token },\r\n      })\r\n      .then(() => {\r\n        back();\r\n      })\r\n      .catch((error) => {\r\n        dispatch(setLoading(false));\r\n        dispatch(setError(error.response.data));\r\n      })\r\n      .finally(() => {\r\n        dispatch(setLoading(false));\r\n      });\r\n  };\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}