{"ast":null,"code":"import React,{useEffect,useRef,useState}from\"react\";import Card from\"./Card\";import{useDispatch,useSelector}from\"react-redux\";import{useLocation}from\"react-router-dom\";import{addItemLast,getProducts,setError,setLoading,setCurrentPage}from\"../store/slices/Product\";import axios from\"axios\";import{API}from\"../store/hook\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const Cards=()=>{var _product$data,_product$data$results,_data$results;let params=useLocation();const{data,loading}=useSelector(state=>state.product);const{product}=useSelector(state=>state);const dispatch=useDispatch();const[totalCount,settotalCount]=useState(0);const[next,setNext]=useState();const AfterGet=data=>{settotalCount(data===null||data===void 0?void 0:data.count);setNext(data===null||data===void 0?void 0:data.next);};const handleNextPage=()=>{axios.get(\"\".concat(API,\"/product/\").concat(params.search?params.search:\"\"),{params:{page_size:12,page:product.currentPage+1}}).then(response=>{var _response$data;dispatch(addItemLast((_response$data=response.data)===null||_response$data===void 0?void 0:_response$data.results));AfterGet(response.data);dispatch(setCurrentPage(product.currentPage+1));}).catch(error=>{var _error$response;return dispatch(setError(error===null||error===void 0?void 0:(_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.data));}).finally(()=>dispatch(setLoading(false)));};useEffect(()=>{setCurrentPage(1);dispatch(getProducts(params.search,AfterGet));},[params]);useEffect(()=>{dispatch(getProducts());},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"diiiv relative flex-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"cards pb-[24px]\",children:product===null||product===void 0?void 0:(_product$data=product.data)===null||_product$data===void 0?void 0:(_product$data$results=_product$data.results)===null||_product$data$results===void 0?void 0:_product$data$results.map(card=>/*#__PURE__*/_jsx(Card,{item:card},card.id))}),!(data!==null&&data!==void 0&&(_data$results=data.results)!==null&&_data$results!==void 0&&_data$results.length)&&!loading&&/*#__PURE__*/_jsx(\"h1\",{className:\"flex mt-[50px] sm:text-4xl text-2xl text-[#1DBE60] text-center justify-center\",children:\"\\u043D\\u0435\\u0442 \\u0442\\u043E\\u0432\\u0432\\u0430\\u0440\\u043E\\u0432\"}),loading?/*#__PURE__*/_jsx(\"div\",{className:\"z-10 flex-1 pt-10 flex  justify-center items-center  max-w-[1200px]  mx-auto w-full px-[15px] \",children:/*#__PURE__*/_jsx(\"img\",{className:\"w-[100px]\",src:\"https://i.gifer.com/origin/34/34338d26023e5515f6cc8969aa027bca.gif\",alt:\"\"})}):/*#__PURE__*/_jsx(\"div\",{className:\"flex pt-[10px] justify-center\",children:next!==null&&/*#__PURE__*/_jsx(\"button\",{onClick:handleNextPage,className:\"border border-[#1DBE60] px-5 py-2 rounded-[20px] text-[#b2b4bc]\",children:\"\\u043F\\u043E\\u043A\\u0430\\u0437\\u0430\\u0442\\u044C \\u0435\\u0449\\u0451\"})})]});};export default Cards;","map":{"version":3,"names":["React","useEffect","useRef","useState","Card","useDispatch","useSelector","useLocation","addItemLast","getProducts","setError","setLoading","setCurrentPage","axios","API","jsx","_jsx","jsxs","_jsxs","Cards","_product$data","_product$data$results","_data$results","params","data","loading","state","product","dispatch","totalCount","settotalCount","next","setNext","AfterGet","count","handleNextPage","get","concat","search","page_size","page","currentPage","then","response","_response$data","results","catch","error","_error$response","finally","className","children","map","card","item","id","length","src","alt","onClick"],"sources":["/Users/muhammad/Downloads/ayfamarket-main/src/components/Cards.jsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\r\nimport Card from \"./Card\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { useLocation } from \"react-router-dom\";\r\nimport {\r\n  addItemLast,\r\n  getProducts,\r\n  setError,\r\n  setLoading,\r\n  setCurrentPage,\r\n} from \"../store/slices/Product\";\r\nimport axios from \"axios\";\r\nimport { API } from \"../store/hook\";\r\n\r\nconst Cards = () => {\r\n  let params = useLocation();\r\n  const { data, loading } = useSelector((state) => state.product);\r\n  const { product } = useSelector((state) => state);\r\n  const dispatch = useDispatch();\r\n  const [totalCount, settotalCount] = useState(0);\r\n  const [next, setNext] = useState();\r\n  const AfterGet = (data) => {\r\n    settotalCount(data?.count);\r\n    setNext(data?.next);\r\n  };\r\n\r\n  const handleNextPage = () => {\r\n    axios\r\n      .get(`${API}/product/${params.search ? params.search : \"\"}`, {\r\n        params: { page_size: 12, page: product.currentPage  + 1},\r\n      })\r\n      .then((response) => {\r\n        dispatch(addItemLast(response.data?.results));\r\n        AfterGet(response.data);\r\n        dispatch(setCurrentPage(product.currentPage + 1));\r\n      })\r\n      .catch((error) => dispatch(setError(error?.response?.data)))\r\n      .finally(() => dispatch(setLoading(false)));\r\n  };\r\n\r\n  useEffect(() => {\r\n    setCurrentPage(1)\r\n    dispatch(getProducts(params.search, AfterGet));\r\n  }, [params]);\r\n\r\n  useEffect(() => {\r\n    dispatch(getProducts());\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"diiiv relative flex-1\">\r\n      <div className=\"cards pb-[24px]\">\r\n        {product?.data?.results?.map((card) => (\r\n          <Card item={card} key={card.id} />\r\n        ))}\r\n      </div>\r\n      {!data?.results?.length && !loading && (\r\n        <h1 className=\"flex mt-[50px] sm:text-4xl text-2xl text-[#1DBE60] text-center justify-center\">\r\n          нет товваров\r\n        </h1>\r\n      )}\r\n      {loading ? (\r\n        <div className=\"z-10 flex-1 pt-10 flex  justify-center items-center  max-w-[1200px]  mx-auto w-full px-[15px] \">\r\n          <img\r\n            className=\"w-[100px]\"\r\n            src=\"https://i.gifer.com/origin/34/34338d26023e5515f6cc8969aa027bca.gif\"\r\n            alt=\"\"\r\n          />\r\n        </div>\r\n      ) : (\r\n        <div className=\"flex pt-[10px] justify-center\">\r\n          {next !== null && (\r\n            <button\r\n              onClick={handleNextPage}\r\n              className=\"border border-[#1DBE60] px-5 py-2 rounded-[20px] text-[#b2b4bc]\"\r\n            >\r\n          показать ещё\r\n            </button>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Cards;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}