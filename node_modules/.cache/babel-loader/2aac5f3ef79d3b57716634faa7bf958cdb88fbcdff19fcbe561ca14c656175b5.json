{"ast":null,"code":"var _localStorage$getItem;\nimport { createSlice } from \"@reduxjs/toolkit\";\nimport { API } from \"../hook\";\nimport axios from \"axios\";\nimport { changeCart } from \"./Cart\";\nimport { toast } from \"react-toastify\";\nconst userSlice = createSlice({\n  name: \"user\",\n  initialState: {\n    data: JSON.parse((_localStorage$getItem = localStorage.getItem(\"user\")) !== null && _localStorage$getItem !== void 0 ? _localStorage$getItem : \"{}\"),\n    loading: null,\n    error: null\n  },\n  reducers: {\n    setItems: (state, {\n      payload\n    }) => {\n      state.data = payload;\n    },\n    setError: (state, {\n      payload\n    }) => {\n      state.error = payload;\n    },\n    setLoading: (state, payload) => {\n      state.loading = payload;\n    }\n  }\n});\nexport const {\n  setItems,\n  setError,\n  setLoading\n} = userSlice.actions;\nexport default userSlice.reducer;\nexport const registration = data => {\n  return async dispatch => {\n    dispatch(setLoading(true));\n    axios.post(`${API}/auth/register/`, data, {\n      headers: {\n        \"Content-Type\": \"multipart/form-data\"\n      }\n    }).then(response => {\n      dispatch(setItems(response.data));\n      localStorage.setItem(\"token\", response.data.token);\n      localStorage.setItem(\"user\", JSON.stringify(response.data));\n      window.location.replace(\"/\");\n    }).catch(error => {\n      dispatch(setError(error.response.data));\n      dispatch(setLoading(false));\n    }).finally(() => {\n      toast.success(\"ðŸ¦„ Wow so easy!\", {\n        position: \"top-right\",\n        autoClose: 5000,\n        hideProgressBar: false,\n        closeOnClick: true,\n        pauseOnHover: true,\n        draggable: true,\n        progress: undefined,\n        theme: \"light\"\n      });\n      dispatch(setLoading(false));\n    });\n  };\n};\nexport const login = data => {\n  return async dispatch => {\n    dispatch(setLoading(true));\n    axios.post(`${API}/auth/login/`, data).then(response => {\n      dispatch(setItems(response.data));\n      localStorage.setItem(\"token\", response.data.token_key);\n      localStorage.setItem(\"user\", JSON.stringify(response.data));\n      window.location.replace(\"/\");\n    }).catch(error => {\n      dispatch(setLoading(false));\n      dispatch(setError(error.response.data));\n    }).finally(() => dispatch(setLoading(false)));\n  };\n};\nexport const getProfile = id => {\n  return async dispatch => {\n    dispatch(setLoading(true));\n    axios.get(`${API}/auth/profile/${id}/`).then(response => {\n      dispatch(setItems(response.data));\n      localStorage.setItem(\"token\", response.data.token_key);\n      localStorage.setItem(\"user\", JSON.stringify(response.data));\n    }).catch(error => {\n      dispatch(setLoading(false));\n      dispatch(setError(error.response.data));\n    }).finally(() => dispatch(setLoading(false)));\n  };\n};\nexport const changeUserData = (data, id, back) => {\n  return async dispatch => {\n    dispatch(setLoading(true));\n    axios.patch(`${API}/auth/profile/${id}/`, data, {\n      headers: {\n        \"Content-Type\": \"multipart/form-data\"\n      }\n    }).then(response => {\n      dispatch(setItems(response.data));\n      localStorage.setItem(\"token\", response.data.token_key);\n      localStorage.setItem(\"user\", JSON.stringify(response.data));\n      back();\n    }).catch(error => {\n      dispatch(setLoading(false));\n      dispatch(setError(error.response.data));\n    }).finally(() => {\n      dispatch(setLoading(false));\n    });\n  };\n};\nexport const changeUserPassword = (data, back) => {\n  return async dispatch => {\n    dispatch(setLoading(true));\n    const token = `Token ${localStorage.getItem(\"token\")}`;\n    axios.patch(`${API}/auth/change-password/`, data, {\n      headers: {\n        Authorization: token\n      }\n    }).then(() => {\n      back();\n    }).catch(error => {\n      dispatch(setLoading(false));\n      dispatch(setError(error.response.data));\n    }).finally(() => {\n      dispatch(setLoading(false));\n    });\n  };\n};","map":{"version":3,"names":["createSlice","API","axios","changeCart","toast","userSlice","name","initialState","data","JSON","parse","_localStorage$getItem","localStorage","getItem","loading","error","reducers","setItems","state","payload","setError","setLoading","actions","reducer","registration","dispatch","post","headers","then","response","setItem","token","stringify","window","location","replace","catch","finally","success","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","undefined","theme","login","token_key","getProfile","id","get","changeUserData","back","patch","changeUserPassword","Authorization"],"sources":["/Users/muhammad/Downloads/ayfamarket-main/src/store/slices/User.js"],"sourcesContent":["import { createSlice } from \"@reduxjs/toolkit\";\r\nimport { API } from \"../hook\";\r\nimport axios from \"axios\";\r\nimport { changeCart } from \"./Cart\";\r\nimport { toast } from \"react-toastify\";\r\n\r\nconst userSlice = createSlice({\r\n  name: \"user\",\r\n  initialState: {\r\n    data: JSON.parse(localStorage.getItem(\"user\") ?? \"{}\"),\r\n    loading: null,\r\n    error: null,\r\n  },\r\n  reducers: {\r\n    setItems: (state, { payload }) => {\r\n      state.data = payload;\r\n    },\r\n    setError: (state, { payload }) => {\r\n      state.error = payload;\r\n    },\r\n    setLoading: (state, payload) => {\r\n      state.loading = payload;\r\n    },\r\n  },\r\n});\r\n\r\nexport const { setItems, setError, setLoading } = userSlice.actions;\r\nexport default userSlice.reducer;\r\n\r\nexport const registration = (data) => {\r\n  return async (dispatch) => {\r\n    dispatch(setLoading(true));\r\n    axios\r\n      .post(`${API}/auth/register/`, data, {\r\n        headers: {\r\n          \"Content-Type\": \"multipart/form-data\",\r\n        },\r\n      })\r\n      .then((response) => {\r\n        dispatch(setItems(response.data));\r\n        localStorage.setItem(\"token\", response.data.token);\r\n        localStorage.setItem(\"user\", JSON.stringify(response.data));\r\n        window.location.replace(\"/\");\r\n      })\r\n      .catch((error) => {\r\n        dispatch(setError(error.response.data));\r\n        dispatch(setLoading(false));\r\n      })\r\n      .finally(() => {\r\n        toast.success(\"ðŸ¦„ Wow so easy!\", {\r\n          position: \"top-right\",\r\n          autoClose: 5000,\r\n          hideProgressBar: false,\r\n          closeOnClick: true,\r\n          pauseOnHover: true,\r\n          draggable: true,\r\n          progress: undefined,\r\n          theme: \"light\",\r\n        });\r\n        dispatch(setLoading(false));\r\n      });\r\n  };\r\n};\r\n\r\nexport const login = (data) => {\r\n  return async (dispatch) => {\r\n    dispatch(setLoading(true));\r\n    axios\r\n      .post(`${API}/auth/login/`, data)\r\n      .then((response) => {\r\n        dispatch(setItems(response.data));\r\n        localStorage.setItem(\"token\", response.data.token_key);\r\n        localStorage.setItem(\"user\", JSON.stringify(response.data));\r\n        window.location.replace(\"/\");\r\n      })\r\n      .catch((error) => {\r\n        dispatch(setLoading(false));\r\n        dispatch(setError(error.response.data));\r\n      })\r\n      .finally(() => dispatch(setLoading(false)));\r\n  };\r\n};\r\n\r\nexport const getProfile = (id) => {\r\n  return async (dispatch) => {\r\n    dispatch(setLoading(true));\r\n    axios\r\n      .get(`${API}/auth/profile/${id}/`)\r\n      .then((response) => {\r\n        dispatch(setItems(response.data));\r\n        localStorage.setItem(\"token\", response.data.token_key);\r\n        localStorage.setItem(\"user\", JSON.stringify(response.data));\r\n      })\r\n      .catch((error) => {\r\n        dispatch(setLoading(false));\r\n        dispatch(setError(error.response.data));\r\n      })\r\n      .finally(() => dispatch(setLoading(false)));\r\n  };\r\n};\r\n\r\nexport const changeUserData = (data, id, back) => {\r\n  return async (dispatch) => {\r\n    dispatch(setLoading(true));\r\n    axios\r\n      .patch(`${API}/auth/profile/${id}/`, data, {\r\n        headers: {\r\n          \"Content-Type\": \"multipart/form-data\",\r\n        },\r\n      })\r\n      .then((response) => {\r\n        dispatch(setItems(response.data));\r\n        localStorage.setItem(\"token\", response.data.token_key);\r\n        localStorage.setItem(\"user\", JSON.stringify(response.data));\r\n        back();\r\n      })\r\n      .catch((error) => {\r\n        dispatch(setLoading(false));\r\n        dispatch(setError(error.response.data));\r\n      })\r\n      .finally(() => {\r\n        dispatch(setLoading(false));\r\n      });\r\n  };\r\n};\r\n\r\nexport const changeUserPassword = (data, back) => {\r\n  return async (dispatch) => {\r\n    dispatch(setLoading(true));\r\n    const token = `Token ${localStorage.getItem(\"token\")}`;\r\n    axios\r\n      .patch(`${API}/auth/change-password/`, data, {\r\n        headers: { Authorization: token },\r\n      })\r\n      .then(() => {\r\n        back();\r\n      })\r\n      .catch((error) => {\r\n        dispatch(setLoading(false));\r\n        dispatch(setError(error.response.data));\r\n      })\r\n      .finally(() => {\r\n        dispatch(setLoading(false));\r\n      });\r\n  };\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}